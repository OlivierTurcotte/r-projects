{
    "collab_server" : "",
    "contents" : "---\ntitle: \"4.1.2.3\"\nauthor: \"Olivier Turcotte\"\noutput: pdf_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n```{r,include = F}\nr <- 2 ; q <- 0.997\na <- 2; b <- 1/5000\nk0 <- 1000\n```\n\n## (a)\n$$\n\\begin{aligned}\nE[X_1] &= E[M]*E[B] = `r r*(1-q)/q*a/b`\\\\\nVaR_0.99(X_1) &= 0 \\\\\n\\rightarrow TVaR_0.99(X_1) &= \\frac{E[X_1]}{1-0.99}\\\\\n&= `r r*(1-q)/q*a/b/(1-0.99)`\\\\\n\\end{aligned}\n$$\n\n## (b)\n\n```{r, include = F}\nFS <- function(x,n) dnbinom(0,n*r,q)+sum(sapply(seq_len(k0),function(i) dnbinom(i,n*r,q)*pgamma(x,a*i,b)))\n\nVaR <- function(k,n) ifelse(dnbinom(0,n*r,q) > k, 0 , uniroot(function(x) FS(x,n)-k,c(0,10000000))$root)\n\nTVaR <- function(k,n) {\n    v <- VaR(k,n)\n    sum(sapply(seq_len(k0),function(i) dnbinom(i,n*r,q)*a*i/b*(1-pgamma(v,a*i+1,b))))/(1-k)}\n\n```\n\n\n$$\n\\begin{aligned}\nS_n &\\sim BinNegComp(r^\\ast = r*n, F_B)\\\\\nE[S_n] &= nE[X_1] = \\{`r 10*r*(1-q)/q*a/b`,`r 100*r*(1-q)/q*a/b`,`r 100*r*(1-q)/q*a/b`\\}\\\\\nVaR_0.99(S_n) &= \\{`r VaR(0.99,10)`,`r VaR(0.99,100)`,`r VaR(0.99,1000)`\\}\\\\\nTVaR_0.99(S_n) &= \\{`r TVaR(0.99,10)`,`r TVaR(0.99,100)`,`r TVaR(0.99,1000)`\\}\\\\\n\\end{aligned}\n$$\n\n```{r, eval = F}\nFS <-\n    function(x, n)\n    dnbinom(0, n * r, q) + sum(sapply(seq_len(k0), function(i)\n    dnbinom(i, n * r, q) * pgamma(x, a * i, b)))\n    \n    VaR <-\n    function(k, n)\n    ifelse(dnbinom(0, n * r, q) > k, 0 , uniroot(function(x)\n    FS(x, n) - k, c(0, 10000000))$root)\n    \n    TVaR <- function(k, n) {\n    v <- VaR(k, n)\n    sum(sapply(seq_len(k0), function(i)\n    dnbinom(i, n * r, q) * a * i / b * (1 - pgamma(v, a * i + 1, b)))) / (1 -\n    k)\n    }\n    \n```\n\n## (c)\n\n$\\sum_{i=1}^nVaR_0.99(X_i) = n*VaR_0.99(X) = n*0 = 0 < VaR_0.99(S_n)$: La VaR n'est pas sous-additive.\n\n## (d)\n\n```{r}\nsapply(c(10,100,1000),function(n) r*(1-q)/q*a/b/(1-0.99)*n > TVaR(0.99,n))\n```\nTVaR sous-additive.\n\n\n",
    "created" : 1522421726491.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3584051469",
    "id" : "B19F0652",
    "lastKnownWriteTime" : 1522423936,
    "last_content_update" : 1522423936804,
    "path" : "~/Actuariat/Première année/Session 2/r-projects/Olivier/Intro II/CH04/4.1.2.3.Rmd",
    "project_path" : null,
    "properties" : {
        "last_setup_crc32" : "11E69B11bb338d19",
        "tempName" : "Untitled2"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}