{
    "collab_server" : "",
    "contents" : "# Dépannage 03-29-18\n# Auteur: Deniz Alic\n\n## Chapitre 5 - Euler ##\n\n#### 5.1.3 ####\nrm(list=ls())\n\np <- c(0.75, 0.25)\n\nbe1 <- c(1/10, 1/40)\nbe2 <- c(1/20, 1/80)\nbe3 <- c(1/40, 1/10)\n\nex1 <- sum(p * 1/be1)\nex2 <-sum(p * 1/be2)\nex3 <- sum(p * 1/be3)\n\nvax1 <- sum (p * 2 / be1^2) - ex1^2\nvax2 <- sum (p * 2 / be2^2) - ex2^2\nvax3 <- sum (p * 2 / be3^2) - ex3^2\n\ncov_x1x2 <- sum(p * 1/be1 * 1/be2) - ex1 * ex2\ncov_x1x3 <- sum(p * 1/be1 * 1/be3) - ex1 * ex3\ncov_x2x3 <- sum(p * 1/be2 * 1/be3) - ex2 * ex3\n\nes <- ex1 + ex2 + ex3\nvas <- vax1 + vax2 + vax3 +\n  2 * (cov_x1x2 + cov_x1x3 + cov_x2x3)\n\n\nkappa <- 0.99\n\nc1 <- ex1 + qnorm(kappa) * (vax1 + cov_x1x2 + cov_x1x3) / sqrt(vas)\nc2 <- ex2 + qnorm(kappa) * (vax2 + cov_x1x2 + cov_x2x3) / sqrt(vas)\nc3 <- ex3 + qnorm(kappa) * (vax3 + cov_x1x3 + cov_x2x3) / sqrt(vas)\nctot <- es + qnorm(kappa) * sqrt(vas)\n\ndata.frame(c1, c2, c3, ctot, test = c1 + c2 + c3)\n\n# Vérification avec simulation\nm <- 100000\nx1 <- numeric(m)\nx2 <- numeric(m)\nx3 <- numeric(m)\n\nfor(i in 1:m){\n  u <- runif(1)\n  \n  if(u <= p[1]){\n    x1[i] <- rexp(1, be1[1])\n    x2[i] <- rexp(1, be2[1])\n    x3[i] <- rexp(1, be3[1])\n  }\n  else{\n    x1[i] <- rexp(1, be1[2])\n    x2[i] <- rexp(1, be2[2])\n    x3[i] <- rexp(1, be3[2])\n  }\n}\n\ns <- x1 + x2 + x3\n\ndata.frame(ex1, mean(x1), ex2, mean(x2), ex3, mean(x3), es, mean(s))\ndata.frame(cov_x1x2, cov(x1,x2), cov_x1x3, cov(x1,x3), cov_x2x3, cov(x2,x3))\ndata.frame(vax1, var(x1), vax2, var(x2), vax3, var(x3), vas, var(s))\n\nc1_sim <- mean(x1) + qnorm(kappa) * cov(x1, s) / sqrt(var(s))\nc2_sim <- mean(x2) + qnorm(kappa) * cov(x2, s) / sqrt(var(s))\nc3_sim <- mean(x3) + qnorm(kappa) * cov(x3, s) / sqrt(var(s))\nctot_sim <- mean(s) + qnorm(kappa) * sqrt(var(s))\n\ndata.frame(c1, c1_sim, c2, c2_sim, c3, c3_sim, ctot, ctot_sim)\n\n#### 5.2.1 ####\nrm(list=ls())\n\nset.seed(2018)\nm = 100000\n\nU = matrix(runif(3*m), nrow=m, byrow=TRUE)\n\nx1 <- qgamma(U[, 1], 10, 1/300)\nx2 <- qgamma(U[, 2], 4, 1/500)\nx3 <- qgamma(U[, 3], 1, 1/1000)\n\ns <- x1 + x2 + x3\n\nx1[c(1, m)]\nx2[c(1, m)]\nx3[c(1, m)]\ns[c(1, m)]\n\nkappa <- c(0.9 ,0.99, 0.999)\nvars <- sort(s)[kappa*m]\ntvars <- sapply(vars, function(t) mean(s[s>t]))\n\ncv1 <- sapply(vars, function(t) sum(x1 * (s == t)))\ncv2 <- sapply(vars, function(t) sum(x2 * (s == t)))\ncv3 <- sapply(vars, function(t) sum(x3 * (s == t)))\n\ndata.frame(kappa, cv1, cv2, cv3, vars, test = cv1 + cv2 + cv3)\n\nct1 <- sapply(vars, function(t) sum(x1 * (s > t))) / (1-kappa) / m\nct2 <- sapply(vars, function(t) sum(x2 * (s > t))) / (1-kappa) / m\nct3 <- sapply(vars, function(t) sum(x3 * (s > t))) / (1-kappa) / m\n\ndata.frame(kappa, ct1, ct2, ct3, tvars, test = ct1 + ct2 + ct3)\n\n#### 5.2.2 ####\nrm(list=ls())\n\nex <- 100\nvax <- 300^2\n\nal_pa <- 2 * vax / ex^2 / (vax / ex^2 - 1)\nlam <- ex * (al_pa - 1)\n\nal_gam <- ex^2 / vax\nbe <- al_gam / ex\n\nsd <- sqrt(log((1 + vax / ex^2)))\nmu <- log(ex) - sd^2 / 2\n\nset.seed(2018)\nm = 100000\n\nU = matrix(runif(3*m), nrow=m, byrow=TRUE)\n\nlibrary(actuar)\nx1 <- qpareto(U[, 1], al_pa, lam)\nx2 <- qgamma(U[, 2], al_gam, be)\nx3 <- qlnorm(U[, 3], mu, sd)\n\ns <- x1 + x2 + x3\n\nkappa <- c(0.9, 0.99, 0.999)\nvars <- sort(s)[kappa*m]\ntvars <- sapply(vars, function(t) mean(s[s>t]))\n\ncv1 <- sapply(vars, function(t) sum(x1 * (s == t)))\ncv2 <- sapply(vars, function(t) sum(x2 * (s == t)))\ncv3 <- sapply(vars, function(t) sum(x3 * (s == t)))\n\ndata.frame(kappa, cv1, cv2, cv3, vars, test = cv1 + cv2 + cv3)\n\nct1 <- sapply(vars, function(t) sum(x1 * (s > t))) / (1-kappa) / m\nct2 <- sapply(vars, function(t) sum(x2 * (s > t))) / (1-kappa) / m\nct3 <- sapply(vars, function(t) sum(x3 * (s > t))) / (1-kappa) / m\n\ndata.frame(kappa, ct1, ct2, ct3, tvars, test = ct1 + ct2 + ct3)\n\n",
    "created" : 1522438296766.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1170911186",
    "id" : "74315E16",
    "lastKnownWriteTime" : 1522438290,
    "last_content_update" : 1522438290,
    "path" : "~/Actuariat/Première année/Session 2/Intro II/Code/act-2001/depannages/03-29-18.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}