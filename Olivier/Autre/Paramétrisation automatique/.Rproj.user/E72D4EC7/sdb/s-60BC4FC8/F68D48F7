{
    "collab_server" : "",
    "contents" : "########## Chapitre 4.1  Exercice Informatique #####################\n\n###### Numero 1 ##########\nrm(list=ls())\nr <- 0.5\nq <- 5/6\nalpha <- 0.5\nbeta <- 1/10000\n\n#a) r* = n*r q*=q\n#b)\n\n(EX <- r*(1-q)/(q)*alpha/beta)\n(ES <- n*r*(1-q)/(q)*alpha/beta )\n\n#c)\n\nrepartitionx <- function(x)\n{\n  dnbinom(0,r,q) + sum(sapply(1:10000,function(i) dnbinom(i,r,q)*pgamma(x,alpha*i,beta)))\n}\nrepartitionx(10000)\n\nn <- 200\n\nrepartitions <- function(x)\n{\n  dnbinom(0,n*r,q) + sum(sapply(1:10000,function(i) dnbinom(i,n*r,q)*pgamma(x,alpha*i,beta)))\n}\nrepartitions(n*10000)\n\n#d)\n\n#VaR0.5 = 0 \nVaRX0.5 <- 0\n(VaRX0.99 <- uniroot(function(x) repartitionx(x)-0.99,c(0,10000000))[[1]])\n\n#e)\n\n(VaRS0.5 <- uniroot(function(x) repartitions(x)-0.5,c(0,100000000000))[[1]])\n(VaRS0.99 <- uniroot(function(x) repartitions(x)-0.99,c(0,100000000000))[[1]])\n\n#f)\n\nTVaRX <- function(x,k)\n{\n\n  sum(sapply(1:10000,function(i) dnbinom(i,r,q)*alpha*i/beta * (1-pgamma(x,alpha*i+1,beta))))/(1-k)\n}\n\nTVaRX(VaRX0.5,0.5)\nTVaRX(VaRX0.99,0.99)\n\n#g)\n\nTVaRS <- function(x,k)\n{\n  \n  sum(sapply(1:10000,function(i) dnbinom(i,n*r,q)*alpha*i/beta * (1-pgamma(x,alpha*i+1,beta))))/(1-k)\n}\n\nTVaRS(VaRS0.5,0.5)\nTVaRS(VaRS0.99,0.99)\n\n#h)\n\n200*VaRX0.5 <= VaRS0.5\n\n#i)\n\n200*VaRX0.99 >= VaRS0.99\n\n#j)\n\n 200 * TVaRX(VaRX0.5,0.5) >= TVaRS(VaRS0.5,0.5)\n \n#k)\n  200 * TVaRX(VaRX0.99,0.99) >= TVaRS(VaRS0.99,0.99)\n  \n# l)  : VaR pas toujours sous-additive , TVaR toujours sous-additive\n\n  \n  \n  \n  \n\n\n  \n###### Numero 2 #########\nrm(list=ls())\nn <- 1000\nlambda <- 0.005\nbeta <- 1/1000\n\n#a)\n#-\nrepartionx <- function(x)\n{\n  dpois(0,lambda) + sum(sapply(1:10000,function(i) dpois(i,lambda)*pgamma(x,i,beta)))\n}\n#-\nrepartionx(5) ## ok \nrepartionx(0)\nrepartionx(10)\n#-\n## Optimize, vérifier si k > fm(0)\n\n#- \n0.99<dpois(0,lambda) \nVaRX0.99 <- 0\n#- esperance de x / 0.01\n\n#-\nTVaRX0.99 <- lambda*1/beta / 0.01\n\n##b)\n#- Wn suit une poiscomp(lambda*n, FB) ou FB suit une expo(lambda*n)\n#- \n  \nrepartionW <- function(x)\n{\n  dpois(0,n*lambda) + sum(sapply(1:10000,function(i) dpois(i,n*lambda)*pgamma(x,i,n*beta)))\n}\n\n#-\nrepartionW(5) ## ok \nsapply(c(0,10),function(x) repartionW(x))\n\n#- Optimize , mais vérifier si k> fm(0)\n#-\n0.99>repartionW(0) ## ok\n\n(VaR0.99 <- uniroot(function(x) repartionW(x)-0.99,c(0,10000000))[[1]])\n\n#- somme(esperance(x * 1{x>d} | M=M) * fm(m))\n\n#-\n(TVaRS0.99 <- sum(sapply(1:100000,function(i) i/(n*beta)*dpois(i,n*lambda)*(1-pgamma(VaR0.99,i+1,n*beta))))/0.01)\n\n## c)\n\nVaRX0.99-VaR0.99 ## négatif ce qui permet d'observer que la VaR n'est pas sous additive : pas positiver de mutualiser selon la VaR\nTVaRX0.99-TVaRS0.99 ## Bénéfice positif à cause de la sous-additivité\n\n\n\n\n\n  \n\n###### Numero 3 ##########\nrm(list=ls())\nalpha <- 2\nbeta <- 1/5000\nr <- 2\nq <- 0.997\n\n#a)\n(EX <- r*(1-q)/q * alpha/beta)\nrepartitionx <- function(x)\n{\n  dnbinom(0,r,q) + sum(sapply(1:10000,function(i) dnbinom(i,r,q)*pgamma(x,alpha*i,beta)))\n}\n\n\n0.99>repartitionx(0)\nVaRX0.99 <- 0\n(TVaRX0.99 <- EX/0.01)\n#b)\nn <- c(10,100,1000)\n(ES <- EX*n)\n# S suit une Bin N comp(n*r,q,FB)\n\nrepartitions1 <- function(x)\n{\n  dnbinom(0,n[1]*r,q) + sum(sapply(1:10000,function(i) dnbinom(i,n[1]*r,q)*pgamma(x,alpha*i,beta)))\n}\nrepartitions2 <- function(x)\n{\n  dnbinom(0,n[2]*r,q) + sum(sapply(1:10000,function(i) dnbinom(i,n[2]*r,q)*pgamma(x,alpha*i,beta)))\n}\nrepartitions3 <- function(x)\n{\n  dnbinom(0,n[3]*r,q) + sum(sapply(1:10000,function(i) dnbinom(i,n[3]*r,q)*pgamma(x,alpha*i,beta)))\n}\n(VaRS0.99 <- c(uniroot(function(x) repartitions1(x)-0.99,c(0,10000000))[[1]],uniroot(function(x) repartitions2(x)-0.99,c(0,10000000))[[1]],uniroot(function(x) repartitions3(x)-0.99,c(0,10000000))[[1]]))\n\nTVaR <- function(x,n)\n{\n  sum(sapply(1:1000,function(i) alpha*i/beta*(1-pgamma(x,alpha*i+1,beta))*dnbinom(i,n*r,q)))/0.01\n}\n\n(TVaRS0.99 <- sapply(1:3,function(i) TVaR(VaRS0.99[i],n[i])))\n\n#c)\n\nn*VaRX0.99-VaRS0.99 ## On voit qu'il n'est pas positive de mutualiser le risque selon la VaR puisqu'elle n'est pas sous-additive\n\n#d)\nn*TVaRX0.99-TVaRS0.99 ##On voit qu'il est  positif de mutualiser le risque selon la TVaR puisqu'elle est sous-additive. Plus n augmente , plus BM grand\n\n##e)\n\n#i) Par l'homogénéité : \n\n(PrimeA <- 1/n * VaRS0.99)\n# ii) Par l'homogénéité :\n(PrimeB <- 1/n * TVaRS0.99) ## Prime plus élevé selon la TVaR...\n\n###### Numero 4 ###########\nrm(list=ls())\np <- 0.2\nbeta <- 1/2500\n#a)\n(EX <- 0.2*1/beta)\n0.2*2500^2 +2500^2 * 0.2 * 0.8\n\n#b)\n\nrepartitionx <- function(x)\n{\n  \n  0.8 + 0.2*pexp(x,beta)\n}\nrepartitionx(0)\nVaRX0.5 <- 0\nEX/0.5\n\n## c)\n\nVaRX0.99 <- uniroot(function(x) repartitionx(x)-0.99,c(0,10000))[[1]]\n\n0.2* (exp(-beta*VaRX0.99)/beta + VaRX0.99*exp(-beta*VaRX0.99))/0.01 ## ok\n\n## d) Développer la forme de la Fx : on voit que ca forme des gammas ...\nprob <- c(0.384,0.096,0.008)\nsum(sapply(1:3,function(i) i/beta * (1-pgamma(11658.566,i+1,beta))*prob[i]))/0.01 ## ok !!\n\n\n\n\n\n\n\n###### Numero 5 ############\nrm(list=ls())\n#a) S suit un Bincomp(6,1/2,FB)\n#b)\nn <- 6\np <- 1/2\nalpha <- 1.2\nlambda <- 1/10\n(ES <- n*p*alpha/lambda)\n(VarS <- n*p*alpha/lambda^2 + (alpha/lambda)^2 * n*p*(1-p))\n#c)\n\nrepartitions <- function(x)\n{\n  dbinom(0,n,p) + sum(sapply(1:6,function(i) dbinom(i,n,p)*pgamma(x,alpha*i,lambda)))\n}\nsapply(c(0,10,50,100),function(x) repartitions(x))\nkappa <- c(0.5,0.9,0.99,0.999,0.9999)\n(VaRS <- sapply(kappa,function(x) uniroot(function(y) repartitions(y)-x,c(0,10000000))[[1]]))\n\n\nTVaR <- function(x,k)\n{\n  sum(sapply(1:6,function(i) dbinom(i,n,p)*alpha*i/lambda*(1-pgamma(x,alpha*i+1,lambda))))/(1-k)\n}\nVaRS\n(TVaRS <- sapply(1:5,function(i) TVaR(VaRS[i],kappa[i])))  ## ca semble correct\n\n  \n  \n  \n\n\n\n\n\n\n\n###### Numero 6 #############\nrm(list=ls())\nn <- 2\np <- 1/2\nalpha <- 1.2\nbeta <- 1/10\n#a) M1 suit M2 qui suit M3 qui suit une binominale(2,1/2)\n#b) S suit une bincomp(2,1/2,FB) ou FB suit une gamma(3*1.2,beta)\n#c)\n\nrepartitions <- function(x)\n{\n  dbinom(0,n,p) + dbinom(1,n,p)*pgamma(x,3*alpha,beta) + dbinom(2,n,p)*pgamma(x,6*alpha,beta)\n}\nsapply(c(0,10,50,100),function(x) repartitions(x))\nkappa <- c(0.5,0.9,0.99,0.999,0.9999)\n(VaRS <- sapply(kappa,function(x) uniroot(function(y) repartitions(y)-x,c(0,10000000))[[1]]))\n\nTVaR <- function(x,k)\n{\n  sum(sapply(1:2,function(i) dbinom(i,n,p)*3*alpha*i/beta*(1-pgamma(x,3*alpha*i+1,beta))))/(1-k)\n}\nVaRS\n(TVaRS <- sapply(1:5,function(i) TVaR(VaRS[i],kappa[i]))) ## Ca semble ok\n\n\n\n\n###### Numero 7 #############\nrm(list=ls())\nalpha <- 3.6\nbeta <- 1/10\n#a) M1 suit M2 qui suit M3 qui suit une binominale(2,1/2)\n#b) S suit une gamme(alpha,beta)\n#c)\nES <- alpha/beta\nVarS <- alpha/beta^2\npgamma(c(0,10,50,100),alpha,beta)\nkappa <- c(0.5,0.9,0.99,0.999,0.9999)\nVaRS <- qgamma(kappa,alpha,beta)\nVaRS\n(TVaRS <- sapply(1:5,function(i) alpha/beta * (1-pgamma(VaRS[i],alpha+1,beta))/(1-kappa[i])))",
    "created" : 1522287109078.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1648910017",
    "id" : "F68D48F7",
    "lastKnownWriteTime" : 1522286869,
    "last_content_update" : 1522286869,
    "path" : "~/Actuariat/Première année/Session 2/r-projects/Guillaume/Intro II/exercice 4.1 .r",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}