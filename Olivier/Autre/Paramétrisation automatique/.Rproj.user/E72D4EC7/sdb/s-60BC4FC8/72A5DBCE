{
    "collab_server" : "",
    "contents" : "---\ntitle: \"4.1.2.1\"\nauthor: \"Olivier Turcotte\"\noutput: pdf_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n## (a)\n\n$$\nS_n \\sim BinNegComp( r*n,q, F_B) \n$$\n\n## (b)\n\n$$\n\\begin{aligned}\nE[X] &= \\frac{r*(1-q)}{q}*\\frac{\\alpha}{\\beta}\\\\\nE[S_n] &= \\frac{n*r*(1-q)}{q}*\\frac{\\alpha}{\\beta}\\\\\n\\end{aligned}\n$$\n\n## (c)\n```{r}\nr <- 0.5 ; q <- 5/6 \na <- 0.5 ; b <- 1/10000\nk0 <- 1000\n\nFs <- function(x,n) dnbinom(0,n*r,q)+\n    sum(sapply(seq_len(k0),function(i) dnbinom(i,n*r,q)*pgamma(x,a*i,b))) \n\nFx <- function(x) Fs(x,1)\n\nFx(10000)\nFs(10000,200)\n```\n## (d)\n```{r}\nVaR_S <- function(k,n,interval) ifelse(dnbinom(0,n*r,q) >= k,0,uniroot(\n    function(x) Fs(x,n)-k,interval)$root )\n\nVaR_X <- function(k,interval) VaR_S(k,1,interval)\n\nVaR_X(.5,c(0,10000))\nVaR_X(0.99,c(0,100000))\n```\n\n## (e)\n```{r}\nVaR_S(0.5,200,c(0,100000))\nVaR_S(0.99,200,c(0,300000))\n```\n\n## (f)\n```{r}\nTVaR_S <- function(k,n,interval){\n    VaR <- VaR_S(k,n,interval)\n    if(VaR == 0) n*r*(1-q)/q*a/b\n    else{\n        sum(sapply(seq_len(k0),function(i) dnbinom(i,n*r,q)*a*i/b*(1-pgamma(VaR,a*i+1,b))))/(1-k)\n    }\n}\n\nTVaR_X <- function(k,interval) TVaR_S(k,1,interval)\nTVaR_X(0.5,c(0,10000))\nTVaR_X(0.99,c(0,20000))\n\n```\n## (g)\n```{r}\nTVaR_S(0.5,200,c(0,10e6))\nTVaR_S(0.99,200,c(0,10e6))\n```\n\n## (h)\n```{r}\n200*VaR_X(0.5,c(0,10000)) > VaR_S(0.5,200,c(0,10e4))\n```\n\n## (i)\n```{r}\n200*VaR_X(0.99,c(0,20000)) > VaR_S(0.99,200,c(0,10e6))\n```\n\n## (j)\n```{r}\n200*TVaR_X(0.5,c(0,10000)) > TVaR_S(0.5,200,c(0,10e6))\n```\n\n## (k)\n```{r}\n200*TVaR_X(0.99,c(0,10e6)) > TVaR_S(0.99,200,c(0,10e6))\n```\n\n\n",
    "created" : 1522283349017.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "116473185",
    "id" : "72A5DBCE",
    "lastKnownWriteTime" : 1522286810,
    "last_content_update" : 1522286810724,
    "path" : "~/Actuariat/Première année/Session 2/r-projects/Olivier/Intro II/CH04/4.1.2.1.Rmd",
    "project_path" : null,
    "properties" : {
        "last_setup_crc32" : "11E69B11bb338d19",
        "tempName" : "Untitled5"
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}