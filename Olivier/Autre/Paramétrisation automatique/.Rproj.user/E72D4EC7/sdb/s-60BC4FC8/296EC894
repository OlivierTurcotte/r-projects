{
    "collab_server" : "",
    "contents" : "---\ntitle: \"4.3.1\"\nauthor: \"Olivier Turcotte\"\ndate: \"22 mars 2018\"\noutput: pdf_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n```{r, include=FALSE}\np_ga <- c(a =2,b =1/1000)\n\np_burr <- c(a =2,l =200000, t =1.5)\n\np_ll <- c(t =4,l =2000)\n\np_bern <- c(q = 0.1)\np_lnorm <- c(u = 9.5,sig = 1)\n\np_bin <- c( n = 1000, q =0.97)\n\nE <- numeric(0)\nE[1] <- p_ga[1]/p_ga[2]\n\nE[2] <- 1/gamma(p_burr[1])*p_burr[2]^{1/p_burr[3]}*gamma(1+1/p_burr[3])*gamma(p_burr[1] -1/p_burr[3])\n\nE[3] <- p_ll[2]*gamma(1+1/p_ll[\"t\"])*gamma(1-1/p_ll[\"t\"])\n\nE[4] <- p_bern[1]*exp(p_lnorm[\"u\"]+p_lnorm[\"sig\"]^2/2)\n\nE[5] <- 2*p_bin[\"n\"]*p_bin[\"q\"]\n\nfacteurs <- c(1.25,1.1,1.2,1.3,0.995)\nP <- facteurs*E\n\nLtot <- sum(E[-5])-sum(P[-5])-E[5]+P[5]\n```\n\n## (a)\n\n$$\n\\begin{aligned}\nE[X_1] &=  `r  E[1]`\\\\\n\\Pi_1 &= `r P[1]`\\\\\n\\\\\nE[X_2] &=  `r  E[2]`\\\\\n\\Pi_2 &= `r P[2]`\\\\\n\\\\\nE[X_3] &=  `r  E[3]`\\\\\n\\Pi_3 &= `r P[3]`\\\\\n\\\\\nE[X_4] &=  `r  E[4]`\\\\\n\\Pi_4 &= `r P[4]`\\\\\n\\\\\nE[X_5] &=  `r  E[5]`\\\\\n\\Pi_5 &= `r P[5]`\\\\\n\\end{aligned}\n$$\n## (b)\n\n$$\n\\begin{aligned}\nE[L_{TOT}] &= E[\\sum_{i = 1}^5 L_i]\\\\\n&= \\sum_{i=1}^5E[L_i]\\\\\n&= \\sum_{i=1}^4 E[X_i-\\Pi_i]  + E[\\Pi_5-X_5]\\\\\n&= \\sum_{i=1}^4 E[X_i]-E[\\Pi_i] + E[\\Pi_5]-E[X_5]\\\\\n&= `r Ltot`\n\\end{aligned}\n$$\n## (c)\n\nSimulation: \n```{r}\nset.seed(20130402)\nlibrary(actuar)\n\nn <- 100000\n\np_ga <- c(a =2,b =1/1000)\n\np_burr <- c(a =2,l =200000, t =1.5)\n\np_ll <- c(t =4,l =2000)\n\np_bern <- c(q = 0.1)\np_lnorm <- c(u = 9.5,sig = 1)\n\np_bin <- c( n = 1000, q =0.97)\n\nX.names <- c(\"X1\",\"X2\",\"X3\",\"X4\",\"X5\")\nX <- sapply(X.names,function(x) NULL)  ## Empty list with names\n\n## List of quantiles functions.\nFx_inv <- list()\nFx_inv[[1]] <- function(x) qgamma(x,p_ga[\"a\"],p_ga[\"b\"])\nFx_inv[[2]] <- function(x) qburr(x,p_burr[\"a\"],p_burr[\"l\"],p_burr[\"t\"])\nFx_inv[[3]] <- function(x) qllogis(x,p_ll[\"t\"],p_ll[\"l\"])\nFx_inv[[4]] <- function(x) qbinom(x,1,p_bern[\"q\"])*qlnorm(x,p_lnorm[\"u\"],p_lnorm[\"sig\"])\nFx_inv[[5]] <- function(x) 2*qbinom(x,p_bin[\"n\"],p_bin[\"q\"])\n\nU <- numeric(0)\nfor(i in seq_len(n)){\n    U <- runif(5)\n    for(j in seq_len(5)){\n        X[[j]] <- c(X[[j]],Fx_inv[[j]](U[j]))  ## Append to end of vector\n    }\n}\n\n```\n\n",
    "created" : 1521727343277.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2858655333",
    "id" : "296EC894",
    "lastKnownWriteTime" : 1521748885,
    "last_content_update" : 1521748885712,
    "path" : "~/Actuariat/Première année/Session 2/r-projects/Olivier/Intro II/CH04/4.3.1.Rmd",
    "project_path" : null,
    "properties" : {
        "last_setup_crc32" : "",
        "tempName" : "Untitled4"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}