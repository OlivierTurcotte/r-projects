{
    "collab_server" : "",
    "contents" : "\n# Question 1 ----\nrm(list = ls())\nn <- c(10,400,1000,2000)\na <-  0.5 ; b <- 0.5\n\npsi <- function(u,n,prime) {\n    1 - pgamma(u+n*prime,a*n,b)\n}\n\n# b)\npgamma(c(10,100,1000),a*c(10,100,1000),b)\n\n# c)\ne_x <- a/b\n\n# d)\npsi(20,n,1.1)\n# n = 0.1\n# Au départ, la probabilité de ruine est plus petite, puis elle augmente \n# pour finalement devenir plus petite qu'initialement.\n\n# e)\npsi(20,n,0.9)\n# n = -0.1\n# La probabilité de ruine ne fait qu'augmenter, jusqu'à devenir presque certaine.\n\n# f)\nroot <- uniroot(function(x) psi(20,1000,x) - 0.01,c(-2,2))$root\nn_grec <- root - 1\n\n# Question 2 ----\nrm(list =ls())\nlibrary(actuar)\nn <- 1000\nlambda <- 0.006\na1 <- 1.5 ; b1 <- 1/(1500)\n\nfmx <- function(x){\n    dpois(x,lambda)\n}\n\nFx <- function(x,n = 10){\n    fmx(0) + sum(sapply(seq(n),function(i) fmx(i)*pgamma(x,a1 * i,b1)))\n}\n\n# a)\n# b)\nFx(0)\nFx(40)\nFx(10000)\n\n# c)\noptimize(function(x) abs(Fx(x) - 0.99), c(0,100))$minimum\n# La VaR 0.99 = 0\n# d)\n# e)\n1/(1-0.99)*lambda*a1/b1\n\n# f)\nfmw <- function(x){\n    dpois(x,1000*lambda)\n}\n\nFw <- function(x){\n    fmw(0) + sum(sapply(seq(25),function(i) fmw(i) *pgamma(x,i*a1,b1*n)))\n}\nFw(0)\nFw(40)\n\n# g)\nroot <- uniroot(function(x) Fw(x) -0.99,c(0,40))$root\nFw(root) # Vérif\n\n# h)\nk <- 0.99\n1/(1-k)*sum(sapply(seq(25),function(i) fmw(i)*a1*i/(b1*n)*(1-pgamma(root,a1*i+1,b1*n))))\n\n# i)\n\n\n\n# Question 3 ----\nai <- c(4,2)\nbi <- c(1/100,1/200)\n\nf <- function(x){\n    b <- 1/100\n    a <- 6\n    o <- 0.25\n    p_k <- function(k){\n        \n        l_k <- function(k){\n            sum(sapply(1:2,function(i) ai[i]/k*(1-bi[i]/b)^k))\n        }\n        e_k <- function(k) {\n            if(k == 0) return(1)\n            1/k*sum(sapply(seq(k),function(i) i*l_k(i)*e_k(k-i)))\n        }\n        o*e_k(k)\n    }\n    sum(sapply(0:12,function(k) p_k(k)*pgamma(x,a+k,b)))\n}\nFt <- function(x){\n    0.75*pgamma(x,4,1/100)+0.25*f(x)\n}\n# J'ai fait 12 itérations car à 100, ÇA CRASH TABARNAK. \n#                       - Olivier Turcotte \nsapply(c(100,500,800,1000),Ft)\n\n# Question 4 ----\n\nn <- 3\na <- 1\nb <- 3\n# Pour savoir comment je suis arrivé à cette distribution\n# consulté le onenote.\nfN <- function(k){\n    choose(3,k)*beta(k+a,n-k+b)/beta(a,b)\n}\n# c)\nfN(0:3)\n\n# d)\n1000*fN(3)\n\nfN2 <- function(k){\n    dbinom(k,3,a/(a+b))\n}\n# c2 )\nfN2(0:3)\n\n# d2)\n1000*fN2(3)\n",
    "created" : 1522246210458.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3857120969",
    "id" : "A7722E15",
    "lastKnownWriteTime" : 1518369023,
    "last_content_update" : 1518369023,
    "path" : "~/Actuariat/Première année/Session 2/r-projects/Olivier/Intro II/Examen 2016.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}