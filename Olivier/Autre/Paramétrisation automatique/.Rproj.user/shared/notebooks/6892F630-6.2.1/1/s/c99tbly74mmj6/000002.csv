"0","theta <- c(1,2)"
"0","p_t <- c(0.75,0.25)"
"0","a <- 0.25"
"0","b <- 1/4000"
"0","Fx <- function(x) sum(p_t*pgamma(x,a*theta,b))"
"0","VaR <- function(k) uniroot(function(x) Fx(x)-k,c(0,100000))$root"
"0","VaR(0.99)"
"1","[1]"
"1"," 10945.27"
"1","
"
"0","TVaR <- function(x) sum(p_t*a*theta/b*(1-pgamma(VaR(x),a*theta+1,b)))"
"0","p_t[1]*a/b*(1-pgamma(VaR(0.99),a+1,b))+p_t[2]*a*theta[2]/b*(1-pgamma(VaR(0.99),a*2+1,b))"
"1","[1]"
"1"," 144.2839"
"1","
"
"0","TVaR(0.99)"
"1","[1]"
"1"," 144.2839"
"1","
"
