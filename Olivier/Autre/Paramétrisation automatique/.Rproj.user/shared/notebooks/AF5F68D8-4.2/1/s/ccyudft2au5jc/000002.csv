"0","FW <- function(x,n) dpois(0,l*n) + sum(sapply(seq_len(k0),function(i)"
"0","    dpois(i,l*n)*pgamma(x,i,beta*n)))"
"0","VaR <- function(k,n) ifelse( dpois(0,l) > k , 0 , uniroot(function(x) FW(x,n)-k,c(0,1000))$root)"
"0","TVaR <- function(k,n){"
"0","    v <- VaR(k,n)"
"0","    sum(sapply(seq_len(k0),function(i) dpois(i,l*n)*i/(beta*n)*(1-pgamma(v,i+1,beta*n))))/(1-k)"
"0","}"
"0","FW(5,1000)"
"1","[1]"
"1"," 0.5639167"
"1","
"
